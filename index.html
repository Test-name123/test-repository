<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <script>
    var x = "x.jpg";

    var o = "0.jpg";
  
    var blank = "blank.jpg";
    
    var pause = 0; // Состояние паузы (0 - пауза снята, 1 - пауза поставлена)
    var all = 0; // Хранит состояние игры (0 - новая игра, 1 - выиграл игрок, 2 - выиграл ПК, 3 - ничья)
    // Хранит состояние занятости ячейки символами(0 - пустая, 1 = х, 2 = 0)
    var a = 0;
    var b = 0;
    var c = 0;
    var d = 0;
    var e = 0;
    var f = 0;
    var g = 0;
    var h = 0;
    var i = 0;
    var temp = ""; // Хранит имя ячейки
    var ok = 0; // Хранит состояние игры (1 - все хорошо, можно продолжать, 0 - что то не так)
    var cf = 0; // Хранит значение персонажа(0 - игрок, 1 - компьютер)
    var choice = 9; // Количество выборов
    var aRandomNumber = 0; // Сохранение рандомного числа
    var comp = 0; // Хнанит выбор ПК
    var wn = 0; // Количество побед игрока
    var ls = 0; // Количество побед компьютера
    var ts = 0; // Количество ничьих

    /*
      Логика, относительно результата игры
    */
    function logicOne() {
      if ((a == 1) && (b == 1) && (c == 1)) all = 1;
      if ((a == 1) && (d == 1) && (g == 1)) all = 1;
      if ((a == 1) && (e == 1) && (i == 1)) all = 1;
      if ((b == 1) && (e == 1) && (h == 1)) all = 1;
      if ((d == 1) && (e == 1) && (f == 1)) all = 1;
      if ((g == 1) && (h == 1) && (i == 1)) all = 1;
      if ((c == 1) && (f == 1) && (i == 1)) all = 1;
      if ((g == 1) && (e == 1) && (c == 1)) all = 1;
      if ((a == 2) && (b == 2) && (c == 2)) all = 2;
      if ((a == 2) && (d == 2) && (g == 2)) all = 2;
      if ((a == 2) && (e == 2) && (i == 2)) all = 2;
      if ((b == 2) && (e == 2) && (h == 2)) all = 2;
      if ((d == 2) && (e == 2) && (f == 2)) all = 2;
      if ((g == 2) && (h == 2) && (i == 2)) all = 2;
      if ((c == 2) && (f == 2) && (i == 2)) all = 2;
      if ((g == 2) && (e == 2) && (c == 2)) all = 2;
      if ((a != 0) && (b != 0) && (c != 0) && (d != 0) && (e != 0) && (f != 0) && (g != 0) && (h != 0) && (i != 0) && (all == 0)) all = 3;
    }

    /*
      Установка значения ПК
    */
    function logicTwo() {
      if ((a == 2) && (b == 2) && (c == 0) && (temp == "")) temp = "C";
      if ((a == 2) && (b == 0) && (c == 2) && (temp == "")) temp = "B";
      if ((a == 0) && (b == 2) && (c == 2) && (temp == "")) temp = "A";
      if ((a == 2) && (d == 2) && (g == 0) && (temp == "")) temp = "G";
      if ((a == 2) && (d == 0) && (g == 2) && (temp == "")) temp = "D";
      if ((a == 0) && (d == 2) && (g == 2) && (temp == "")) temp = "A";
      if ((a == 2) && (e == 2) && (i == 0) && (temp == "")) temp = "I";
      if ((a == 2) && (e == 0) && (i == 2) && (temp == "")) temp = "E";
      if ((a == 0) && (e == 2) && (i == 2) && (temp == "")) temp = "A";
      if ((b == 2) && (e == 2) && (h == 0) && (temp == "")) temp = "H";
      if ((b == 2) && (e == 0) && (h == 2) && (temp == "")) temp = "E";
      if ((b == 0) && (e == 2) && (h == 2) && (temp == "")) temp = "B";
      if ((d == 2) && (e == 2) && (f == 0) && (temp == "")) temp = "F";
      if ((d == 2) && (e == 0) && (f == 2) && (temp == "")) temp = "E";
      if ((d == 0) && (e == 2) && (f == 2) && (temp == "")) temp = "D";
      if ((g == 2) && (h == 2) && (i == 0) && (temp == "")) temp = "I";
      if ((g == 2) && (h == 0) && (i == 2) && (temp == "")) temp = "H";
      if ((g == 0) && (h == 2) && (i == 2) && (temp == "")) temp = "G";
      if ((c == 2) && (f == 2) && (i == 0) && (temp == "")) temp = "I";
      if ((c == 2) && (f == 0) && (i == 2) && (temp == "")) temp = "F";
      if ((c == 0) && (f == 2) && (i == 2) && (temp == "")) temp = "C";
      if ((g == 2) && (e == 2) && (c == 0) && (temp == "")) temp = "C";
      if ((g == 2) && (e == 0) && (c == 2) && (temp == "")) temp = "E";
      if ((g == 0) && (e == 2) && (c == 2) && (temp == "")) temp = "G";
    }

    /*
      Предотвращение победы игрока
    */
    function logicThree() {
      if ((a == 1) && (b == 1) && (c == 0) && (temp == "")) temp = "C";
      if ((a == 1) && (b == 0) && (c == 1) && (temp == "")) temp = "B";
      if ((a == 0) && (b == 1) && (c == 1) && (temp == "")) temp = "A";
      if ((a == 1) && (d == 1) && (g == 0) && (temp == "")) temp = "G";
      if ((a == 1) && (d == 0) && (g == 1) && (temp == "")) temp = "D";
      if ((a == 0) && (d == 1) && (g == 1) && (temp == "")) temp = "A";
      if ((a == 1) && (e == 1) && (i == 0) && (temp == "")) temp = "I";
      if ((a == 1) && (e == 0) && (i == 1) && (temp == "")) temp = "E";
      if ((a == 0) && (e == 1) && (i == 1) && (temp == "")) temp = "A";
      if ((b == 1) && (e == 1) && (h == 0) && (temp == "")) temp = "H";
      if ((b == 1) && (e == 0) && (h == 1) && (temp == "")) temp = "E";
      if ((b == 0) && (e == 1) && (h == 1) && (temp == "")) temp = "B";
      if ((d == 1) && (e == 1) && (f == 0) && (temp == "")) temp = "F";
      if ((d == 1) && (e == 0) && (f == 1) && (temp == "")) temp = "E";
      if ((d == 0) && (e == 1) && (f == 1) && (temp == "")) temp = "D";
      if ((g == 1) && (h == 1) && (i == 0) && (temp == "")) temp = "I";
      if ((g == 1) && (h == 0) && (i == 1) && (temp == "")) temp = "H";
      if ((g == 0) && (h == 1) && (i == 1) && (temp == "")) temp = "G";
      if ((c == 1) && (f == 1) && (i == 0) && (temp == "")) temp = "I";
      if ((c == 1) && (f == 0) && (i == 1) && (temp == "")) temp = "F";
      if ((c == 0) && (f == 1) && (i == 1) && (temp == "")) temp = "C";
      if ((g == 1) && (e == 1) && (c == 0) && (temp == "")) temp = "C";
      if ((g == 1) && (e == 0) && (c == 1) && (temp == "")) temp = "E";
      if ((g == 0) && (e == 1) && (c == 1) && (temp == "")) temp = "G";
    }

    /*
      Cброс истории игр
    */
    function clearOut() {
      document.game.you.value = "0";
      document.game.computer.value = "0";
      document.game.ties.value = "0";
    }

    /*
      Проверка выбираемо пространства
    */
    function checkSpace() {
      if ((temp == "A") && (a == 0)) {
        ok = 1;
        if (cf == 0) a = 1;
        if (cf == 1) a = 2;
      }
      if ((temp == "B") && (b == 0)) {
        ok = 1;
        if (cf == 0) b = 1;
        if (cf == 1) b = 2;
      }
      if ((temp == "C") && (c == 0)) {
        ok = 1;
        if (cf == 0) c = 1;
        if (cf == 1) c = 2;
      }
      if ((temp == "D") && (d == 0)) {
        ok = 1;
        if (cf == 0) d = 1;
        if (cf == 1) d = 2;
      }
      if ((temp == "E") && (e == 0)) {
        ok = 1;
        if (cf == 0) e = 1;
        if (cf == 1) e = 2;
      }
      if ((temp == "F") && (f == 0)) {
        ok = 1
        if (cf == 0) f = 1;
        if (cf == 1) f = 2;
      }
      if ((temp == "G") && (g == 0)) {
        ok = 1
        if (cf == 0) g = 1;
        if (cf == 1) g = 2;
      }
      if ((temp == "H") && (h == 0)) {
        ok = 1;
        if (cf == 0) h = 1;
        if (cf == 1) h = 2;
      }
      if ((temp == "I") && (i == 0)) {
        ok = 1;
        if (cf == 0) i = 1;
        if (cf == 1) i = 2;
      }
    }

    /*
      Наш выбор
    */
    function yourChoice(chName) {
      pause = 0;
      if (all != 0) {
        ended();
      }
      if (all == 0) {
        cf = 0;
        ok = 0;
        temp = chName;
        
        checkSpace();
        
        if (ok == 1) {
          document.images[chName].src = x;
        }
        if (ok == 0) {
          taken();
        }
        
        process();
        
        
        if ((all == 0) && (pause == 0)) {
          myChoice();
        }
      }
    }

    /*
      Вывод сообщения про занятую площадь, установка паузы, которая не дает ПК сделать выбор
    */
    function taken() {
      alert("Эта площадь уже занята. Выберите другую площадь.")
      pause = 1;
    }

    /*
      Выбор компьютера
    */
    function myChoice() {
      temp = "";
      ok = 0;
      cf = 1;
      
      logicTwo();
      logicThree();
      checkSpace();
      
      /*
        Если не подходят значения из логики, берется рандомное значение
      */
      while (ok == 0) {
        aRandomNumber = Math.random()
        comp = Math.round((choice - 1) * aRandomNumber) + 1;
        
        if (comp == 1) temp = "A";
        if (comp == 2) temp = "B";
        if (comp == 3) temp = "C";
        if (comp == 4) temp = "D";
        if (comp == 5) temp = "E";
        if (comp == 6) temp = "F";
        if (comp == 7) temp = "G";
        if (comp == 8) temp = "H";
        if (comp == 9) temp = "I";
        checkSpace();
      }
      
      document.images[temp].src = o;
      process();
    }

    /*
      Окончание игры
    */
    function ended() {
      alert("Игра уже закончилась. Чтобы сыграть в новую игру, нажмите кнопку «Воспроизвести снова».")
    }

    /*
      Результаты игр, обновление очков
    */
    function process() {
      logicOne();
      if (all == 1) {
        alert("Вы выиграли, поздравляю!");
        wn++;
      }
      if (all == 2) {
        alert("ПК выиграл!");
        ls++;
      }
      if (all == 3) {
        alert("Мы попытались");
        ts++;
      }
      
      // Обновление очков
      if (all != 0) {
        document.game.you.value = wn;
        document.game.computer.value = ls;
        document.game.ties.value = ts;
      }
    }
    
    /*
      Повтор игры
    */
    function playAgain() {
      if (all == 0) {
        if (confirm("Это перезапустит игру и очистит все текущие оценки. ОК?")) reset();
      }
      if (all > 0){
        reset();
      }
    }

    /*
      Сброс всех значений
    */
    function reset() {
      all = 0;
      a = 0;
      b = 0;
      c = 0;
      d = 0;
      e = 0;
      f = 0;
      g = 0;
      h = 0;
      i = 0;
      temp = "";
      ok = 0;
      cf = 0;
      choice = 9;
      aRandomNumber = 0;
      comp = 0;
      document.images.A.src = blank;
      document.images.B.src = blank;
      document.images.C.src = blank;
      document.images.D.src = blank;
      document.images.E.src = blank;
      document.images.F.src = blank;
      document.images.G.src = blank;
      document.images.H.src = blank;
      document.images.I.src = blank;
//      if (t == 0) {
//        t = 2;
//        myChoice();
//      }
//      t--;
    }
//      var t = 0;
    //  End -->
  </script>
</head>

<body>
  <center>
    <form name=game>
      <table border=0>
        <td>
          <table border=1>
            <tr>
              <!-- Псевдопротокол "javascript:"-->
              <td><a href="javascript:yourChoice('A')"><img src="blank.jpg" border=0 height=100 width=100 name=A></a></td>
              <td><a href="javascript:yourChoice('B')"><img src="blank.jpg" border=0 height=100 width=100 name=B></a></td>
              <td><a href="javascript:yourChoice('C')"><img src="blank.jpg" border=0 height=100 width=100 name=C></a></td>
            </tr>
            <tr>
              <td><a href="javascript:yourChoice('D')"><img src="blank.jpg" border=0 height=100 width=100 name=D></a></td>
              <td><a href="javascript:yourChoice('E')"><img src="blank.jpg" border=0 height=100 width=100 name=E></a></td>
              <td><a href="javascript:yourChoice('F')"><img src="blank.jpg" border=0 height=100 width=100 name=F></a></td>
            </tr>
            <tr>
              <td><a href="javascript:yourChoice('G')"><img src="blank.jpg" border=0 height=100 width=100 name=G></a></td>
              <td><a href="javascript:yourChoice('H')"><img src="blank.jpg" border=0 height=100 width=100 name=H></a></td>
              <td><a href="javascript:yourChoice('I')"><img src="blank.jpg" border=0 height=100 width=100  name=I></a></td>
            </tr>
          </table>
        </td>
        <td>
          <table>
            <tr>
              <td><input type=text size=5 name=you></td>
              <td>Вы</td>
            </tr>
            <tr>
              <td><input type=text size=5 name=computer></td>
              <td>ПК</td>
            </tr>
            <tr>
              <td><input type=text size=5 name=ties></td>
              <td>Ничья</td>
            </tr>
          </table>
        </td>
      </table>
      <input type=button value="Воспроизвести снова" onClick="playAgain();"> &nbsp;&nbsp;
    </form>
  </center>
</body>

</html>
